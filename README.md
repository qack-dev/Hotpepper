# GmailでHOTPEPPERから「予約確定」のメールを受信したら、その内容を解析し、Googleカレンダーに予定を自動で登録する。

### 初心者向けの導入・設定手順

Google Apps Scriptを初めて使う方でも迷わないよう説明します。

#### スクリプトエディタの開き方

1.  まず、ご自身のGoogleアカウントでGoogleドライブ（[drive.google.com](http://drive.google.com)）にアクセスします。
2.  画面左上の「**+ 新規**」ボタンをクリックします。
3.  ドロップダウンメニューから「**その他**」にカーソルを合わせ、「**Google Apps Script**」を選択します。

> **ヒント:** もし「Google Apps Script」が見当たらない場合は、「＋ アプリを追加」を選び、検索窓で`Google Apps Script`と入力して追加してください。

#### コードの貼り付け

1.  新しいタブでスクリプトエディタが開きます。`無題のプロジェクト` という名前になっているはずです。まず、この名前をクリックして `ホットペッパー予約自動登録` のような分かりやすい名前に変更しましょう。
2.  エディタ画面には、最初から`function myFunction() { ... }`というサンプルコードが書かれています。これを全て選択して削除してください。
3.  このGitHubページの上部にある、「**ホットペッパー予約自動登録.gs**」をクリックし、コード全体をコピーし、空になったエディタ画面に貼り付けます。
4.  フロッピーディスクの形をした「**プロジェクトを保存**」アイコンをクリックして、貼り付けたコードを保存します。

#### 実行トリガーの設定（自動化の心臓部！）

このスクリプトを自動で動かすための「トリガー（きっかけ）」を設定します。

1.  エディタ画面の左側にあるメニューから、時計の形をした「**トリガー**」アイコンをクリックします。
2.  画面右下に表示される「**＋ トリガーを追加**」ボタンをクリックします。
3.  新しい設定ウィンドウが開くので、以下のように設定してください。
    *   **実行する関数を選択:** `createEventFromHotPepperMail` を選びます。
    *   **実行するデプロイを選択:** `Head` のままでOKです。
    *   **イベントのソースを選択:** `時間主導型` を選びます。
    *   **時間ベースのトリガーのタイプを選択:** `分タイマー` を選びます。
    *   **時間の間隔を選択（分）:** `10分おき` または `15分おき` を選びます。
    > **なぜ？** Gmailには「特定のメールが来たら即実行」というトリガーが無いため、定期的にメールボックスをチェックする必要があります。`10分おき`に設定すれば、予約メールが届いてから最大でも10分後にはカレンダーに予定が登録されるので、おすすめです。
4.  最後に「**保存**」ボタンをクリックします。

#### 初回実行時の承認プロセス

スクリプトにあなたのGmailとカレンダーを操作する許可を与える、最初の1回だけ必要な作業です。

1.  トリガーを保存すると、"**承認が必要です**"というウィンドウがポップアップします。「**権限を確認**」をクリックしてください。
2.  あなたのGoogleアカウントを選択する画面が表示されるので、ご自身のアカウントをクリックします。
3.  「**このアプリはGoogleで確認されていません**」という警告画面が表示されることがあります。これは自作のプログラムでは通常の表示です。左下にある「**詳細**」もしくは「**Advanced**」をクリックしてください。
   
     <img width="943" height="887" alt="Image" src="https://github.com/user-attachments/assets/ca956e5d-431c-4e40-aac5-da3e91469223" />

4.  「**（先ほど付けたプロジェクト名）に移動（安全ではないページ）**」というリンクが表示されるので、これをクリックして次に進みます。
5.  最後に、「（プロジェクト名）がGoogleアカウントへのアクセスをリクエストしています」という画面が表示されます。スクリプトが「Gmailのメールの閲覧」と「カレンダーの予定の作成」を行うために必要な許可です。内容を確認し、右下の「**許可**」ボタンをクリックしてください。

以上で全ての設定は完了です！これ以降、ホットペッパービューティーから予約確定メールが届くと、設定した間隔でスクリプトが自動的に実行され、あなたのGoogleカレンダーに予定が登録されます。
